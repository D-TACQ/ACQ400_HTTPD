#!/bin/sh

monitor() {
cd /dev/hwmon

for file in */*temp
do
	TX=$(cat $file)
	if [ $TX -ne 0 ]
	then
		TC=$(echo $TX | awk '{ if ($1 > 200) $1/=1000; print $1 }')
		SITE=$(dirname $file)
		case $SITE in
		0)
			echo mainboard $TC;;
		Z)
			echo ZYNQ $TC;;
		*)
			echo SITE$SITE $TC;;
		esac
	fi
done
}


while [ 1 ]
do
	monitor | fs2xml --kvp >/dev/shm/temp.xml
	sleep 5
done



